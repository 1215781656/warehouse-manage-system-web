var K=Object.defineProperty,O=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var I=(u,d,s)=>d in u?K(u,d,{enumerable:!0,configurable:!0,writable:!0,value:s}):u[d]=s,A=(u,d)=>{for(var s in d||(d={}))W.call(d,s)&&I(u,s,d[s]);if(N)for(var s of N(d))X.call(d,s)&&I(u,s,d[s]);return u},L=(u,d)=>O(u,Q(d));var k=(u,d,s)=>new Promise((p,_)=>{var a=i=>{try{f(s.next(i))}catch(y){_(y)}},w=i=>{try{f(s.throw(i))}catch(y){_(y)}},f=i=>i.done?p(i.value):Promise.resolve(i.value).then(a,w);f((s=s.apply(u,d)).next())});import{d as Y,r as g,l as Z,c as M,g as h,b as t,w as o,B as ee,q as x,R as C,f as r,z as le,o as c,h as v,t as $,v as D,H as ae,I as te,D as oe,E as B,_ as se}from"./index-df9e2be5.js";const ne={class:"user-manage card"},de={class:"operation-bar",style:{"margin-bottom":"20px"}},ue=Y({__name:"index",setup(u){const d=g([]),s=g(!1),p=g(!1),_=g("新增用户"),a=g({id:"",username:"",password:"",isActive:!0,role:"employee"}),w=[{label:"管理员",value:"admin"},{label:"员工",value:"employee"}],f=n=>{const e=w.find(m=>m.value===n);return e?e.label:n},i=()=>k(this,null,function*(){s.value=!0;try{const n=yield C.getUserList();d.value=n}finally{s.value=!1}}),y=()=>{_.value="新增用户",a.value={id:"",username:"",password:"",isActive:!0,role:"employee"},p.value=!0},q=n=>{_.value="编辑用户",a.value=L(A({},n),{password:"",role:n.role||"employee"}),p.value=!0},z=n=>{oe.confirm("确认删除该用户吗？","提示",{type:"warning"}).then(()=>k(this,null,function*(){yield C.deleteUser(n.id),B.success("删除成功"),i()}))},R=()=>k(this,null,function*(){try{const n=A({},a.value);n.password||delete n.password,n.role||(n.role="employee"),a.value.id?(yield C.updateUser(a.value.id,n),B.success("更新成功")):(yield C.createUser(n),B.success("创建成功")),p.value=!1,i()}catch(n){}});return Z(i),(n,e)=>{const m=r("el-button"),V=r("el-table-column"),E=r("el-tag"),S=r("el-table"),U=r("el-input"),b=r("el-form-item"),T=r("el-option"),F=r("el-select"),H=r("el-switch"),P=r("el-form"),j=r("el-dialog"),G=le("loading");return c(),M("div",ne,[h("div",de,[t(m,{type:"primary",onClick:y},{default:o(()=>[...e[7]||(e[7]=[v("新增用户",-1)])]),_:1})]),ee((c(),x(S,{data:d.value,style:{width:"100%"},border:""},{default:o(()=>[t(V,{prop:"username",label:"用户名"}),t(V,{label:"角色"},{default:o(({row:l})=>[l.role?(c(),x(E,{key:0,size:"small"},{default:o(()=>[v($(f(l.role)),1)]),_:2},1024)):D("",!0)]),_:1}),t(V,{label:"状态"},{default:o(({row:l})=>[t(E,{type:l.isActive?"success":"danger"},{default:o(()=>[v($(l.isActive?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(V,{label:"操作",width:"200"},{default:o(({row:l})=>[t(m,{type:"primary",link:"",onClick:J=>q(l)},{default:o(()=>[...e[8]||(e[8]=[v("编辑",-1)])]),_:1},8,["onClick"]),t(m,{type:"danger",link:"",onClick:J=>z(l)},{default:o(()=>[...e[9]||(e[9]=[v("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,s.value]]),t(j,{title:_.value,modelValue:p.value,"onUpdate:modelValue":e[6]||(e[6]=l=>p.value=l),width:"500px"},{footer:o(()=>[t(m,{onClick:e[5]||(e[5]=l=>p.value=!1)},{default:o(()=>[...e[10]||(e[10]=[v("取消",-1)])]),_:1}),t(m,{type:"primary",onClick:R},{default:o(()=>[...e[11]||(e[11]=[v("确定",-1)])]),_:1})]),default:o(()=>[t(P,{model:a.value,"label-width":"80px"},{default:o(()=>[t(b,{label:"用户名"},{default:o(()=>[t(U,{modelValue:a.value.username,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.username=l),disabled:!!a.value.id&&a.value.id!==""},null,8,["modelValue","disabled"])]),_:1}),a.value.id?D("",!0):(c(),x(b,{key:0,label:"密码"},{default:o(()=>[t(U,{modelValue:a.value.password,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.password=l),type:"password"},null,8,["modelValue"])]),_:1})),a.value.id?(c(),x(b,{key:1,label:"新密码"},{default:o(()=>[t(U,{modelValue:a.value.password,"onUpdate:modelValue":e[2]||(e[2]=l=>a.value.password=l),type:"password",placeholder:"留空不修改"},null,8,["modelValue"])]),_:1})):D("",!0),t(b,{label:"角色",required:""},{default:o(()=>[t(F,{modelValue:a.value.role,"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.role=l),placeholder:"请选择角色",style:{width:"100%"}},{default:o(()=>[(c(),M(ae,null,te(w,l=>t(T,{key:l.value,label:l.label,value:l.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(b,{label:"状态"},{default:o(()=>[t(H,{modelValue:a.value.isActive,"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.isActive=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}});const pe=se(ue,[["__scopeId","data-v-5245fa20"]]);export{pe as default};
